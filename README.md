# Індивідуальне завдання. Створення цифрового підпису за допомогою алгоритму RSA

У даному репозитрії була створена система цифрового підпису для зображень за допомогою криптографії RSA. 

Цифровий підпис — це метод підтвердження, що файл був створений конкретною особою чи системою, і що цей файл не був змінений після підписання. Це забезпечує **цілісність** (підписане зображення не було змінене після його підписання) і **автентичність** (підпис підтверджує, що зображення справді було підписане власником приватного ключа) файлів.

**RSA** — це один із найпоширеніших алгоритмів для цифрового підпису, де:
- Приватний ключ використовується для підпису.
- Публічний ключ використовується для перевірки підпису.

---

## Генерація пари ключів RSA
Спершу згенеруємо 4096-бітні ключі, які були згадані раніше. Це можна зробити за допомогою OpenSSL. Приватний ключ буде використаний для підпису зображення, а публічний ключ для перевірки підпису. Для цього використаємо такі команди:

```bash
openssl genpkey -algorithm RSA -out private_key.pem -pkeyopt rsa_keygen_bits:4096
```
Ця команда створює приватний ключ розміром 4096 біт і зберігає його у файл _private_key.pem_.

```bash
openssl rsa -pubout -in private_key.pem -out public_key.pem
```
Команда витягує публічний ключ з приватного і зберігає його у файл _public_key.pem_.

---

## Підпис зображення та вбудовування підпису

Для реалізації цифрового підпису я обрала підхід, який передбачає вбудовування підпису у метадані зображення, не змінюючи його візуальний вигляд. Такий метод забезпечує захист цілісності зображення, зберігаючи при цьому його доступність для перегляду стандартними засобами. Цифровий підпис формується на основі гешу зображення (SHA-256), який гарантує унікальність та нечутливість до незначних змін.

Підписування виконується наступним чином:
- Зчитується зображення _image.png_ та отримуються його байти.
- Обчислюється геш зображення за алгоритмом SHA-256.
- Геш підписується приватним ключем RSA (через pkcs1_15).
- Підпис кодується в Base64 та додається до png-метаданих як текстове поле _Signature_.
- Зображення зберігається у новий файл _signed_image.png_.

Цей алгоритм реалізований у файлі _sign_image.py_.

---

## Перевірка цифрового підпису
У цьому кроці ми перевіряємо наявність підпису у зображенні, а також перевіряємо, чи є підпис дійсним, використовуючи публічний ключ RSA, збережений у _public_key.pem_.

Процедура перевірки працює в зворотному порядку:
- Зчитується зображення разом із його метаданими.
- Із метаданих вилучається підпис, якщо він наявний. Якщо підпису немає, виводиться повідомлення: ```Підпис відсутній```.
- Підпис декодується з формату base64 у бінарну форму. Якщо підпис пошкоджено або його неможливо декодувати, буде виведено: ```Неможливо декодувати підпис: <текст помилки>```.
- Зображення конвертується у байти, і на його основі обчислюється геш (SHA-256).
- За допомогою публічного ключа RSA проводиться перевірка.
- Якщо зображення автентичне та не змінене, ви отримаєте повідомлення: ```Підпис правильний```.
- Якщо зображення було змінене або підпис не відповідає даному зображенню, система виведе: ```Підпис недійсний```.

Цей механізм дозволяє відхилити будь-яке зображення, у яке були внесені зміни після підпису, або яке підписане неавторизованим ключем. Навіть мінімальна зміна пікселів зображення призводить до абсолютно іншого гешу тому, якщо зображення після підпису було модифіковане, його геш більше не відповідатиме підпису. Так само, якщо хтось намагається підписати зображення іншим (неавторизованим) ключем, підпис буде визнано недійсним.

Алгоритм реалізований у файлі _verify_signature.py_.

## Встановлення залежностей
Програма написана за допомогою мови Python, для того щоб запустити код потрібно встановити бібліотеки:

```bash
pip install -r requirements.txt
```

## Очікуваний результат
- Якщо підпису немає: ```Підпис відсутній```.
- Якщо система не змогла декодувати підпис з формату base64 (наприклад, підпис пошкоджений або некоректно закодований): ```Неможливо декодувати підпис: <текст помилки>```.
- Якщо зображення автентичне та не змінене, ви отримаєте повідомлення: ```Підпис правильний```.
- Якщо зображення було змінене або підпис не відповідає даному зображенню, система виведе: ```Підпис недійсний```.
  
